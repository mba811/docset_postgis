<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Chapter 11. Topology</title><link rel="stylesheet" href="style.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="PostGIS 2.1.1 Manual"><link rel="up" href="index.html" title="PostGIS 2.1.1 Manual"><link rel="prev" href="RT_FAQ.html" title="Chapter 10. PostGIS Raster Frequently Asked Questions"><link rel="next" href="getfaceedges_returntype.html" title="getfaceedges_returntype"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 11. Topology</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="RT_FAQ.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="getfaceedges_returntype.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter 11. Topology"><div class="titlepage"><div><div><h2 class="title"><a name="Topology"></a>Chapter 11. Topology</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="Topology.html#Topology_Types">11.1. Topology Types</a></span></dt><dt><span class="sect1"><a href="Topology.html#Topology_Domains">11.2. Topology Domains</a></span></dt><dt><span class="sect1"><a href="Topology.html#Topology_ManagementFunctions">11.3. Topology and TopoGeometry Management</a></span></dt><dt><span class="sect1"><a href="Topology.html#Topology_Constructors">11.4. Topology Constructors</a></span></dt><dt><span class="sect1"><a href="Topology.html#Topology_Editing">11.5. Topology Editors</a></span></dt><dt><span class="sect1"><a href="Topology.html#Topology_Accessors">11.6. Topology Accessors</a></span></dt><dt><span class="sect1"><a href="Topology.html#Topology_Processing">11.7. Topology Processing</a></span></dt><dt><span class="sect1"><a href="Topology.html#TopoGeometry_Constructors">11.8. TopoGeometry Constructors</a></span></dt><dt><span class="sect1"><a href="Topology.html#TopoGeometry_Editors">11.9. TopoGeometry Editors</a></span></dt><dt><span class="sect1"><a href="Topology.html#TopoGeom_Accessors">11.10. TopoGeometry Accessors</a></span></dt><dt><span class="sect1"><a href="Topology.html#TopoGeometry_Outputs">11.11. TopoGeometry Outputs</a></span></dt></dl></div><p>The PostGIS Topology types and functions are used to manage topological objects such as faces, edges and nodes. </p><p>Sandro Santilli's presentation at PostGIS Day Paris 2011  conference gives a good synopsis of PostGIS Topology and where it is headed <a class="ulink" href="http://strk.keybit.net/projects/postgis/Paris2011_TopologyWithPostGIS_2_0.pdf" target="_top">Topology with PostGIS 2.0 slide deck</a>.</p><p>Vincent Picavet provides a good synopsis and overview of what is Topology, how is it used, and various FOSS4G tools that support it in <a class="ulink" href="http://2010.foss4g.org/presentations/3555.pdf" target="_top">State of the art of FOSS4G for topology and network analysis</a>.</p><p>An example of a topologically based GIS database is the <a class="ulink" href="http://www.census.gov/geo/www/tiger/overview.html" target="_top">US Census Topologically Integrated Geographic Encoding and Reference System (TIGER)</a> database. If you want to experiment with PostGIS topology and need some data, check out <a class="xref" href="Topology_Load_Tiger.html" title="Topology_Load_Tiger">Topology_Load_Tiger</a>.</p><p>The PostGIS topology module has existed in prior versions of PostGIS but was never part of the Official PostGIS documentation.
	    In PostGIS 2.0.0 major cleanup is going on to remove use of all deprecated functions in it, fix known usability issues, better document the features and functions, add new functions, and enhance to closer conform to SQL-MM standards.</p><p>Details of this project can be found at <a class="ulink" href="http://trac.osgeo.org/postgis/wiki/UsersWikiPostgisTopology" target="_top">PostGIS Topology Wiki</a></p><p>All functions and tables associated with this module are installed in a schema called <code class="varname">topology</code>.</p><p>Functions that are defined in SQL/MM standard are prefixed with ST_ and functions specific to PostGIS are not prefixed.</p><p>To build PostGIS 2.0 with topology support, compile with the --with-topology option as described in <a class="xref" href="postgis_installation.html" title="Chapter 2. PostGIS Installation">Chapter 2, <i>PostGIS Installation</i></a>.  Some functions depend on GEOS 3.3+ so you should compile with GEOS 3.3+ to fully utilize the topology support.</p><div class="sect1" title="11.1. Topology Types"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_Types"></a>11.1. Topology Types</h2></div><div><div class="abstract" title="Abstract"><p class="title"><b>Abstract</b></p><p>This section lists the PostgreSQL data types installed by PostGIS Topology.  Note we describe the casting behavior of these which is very 
                    important especially when designing your own functions.  
                </p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="getfaceedges_returntype.html">getfaceedges_returntype</a></span><span class="refpurpose"> &#8212; A composite type that consists of a sequence number and edge number.  This is the return type for <code class="varname">ST_GetFaceEdges</code></span></dt><dt><span class="refentrytitle"><a href="topogeometry.html">TopoGeometry</a></span><span class="refpurpose"> &#8212; A composite type representing a topologically defined geometry</span></dt><dt><span class="refentrytitle"><a href="validatetopology_returntype.html">validatetopology_returntype</a></span><span class="refpurpose"> &#8212; A composite type that consists of an error message and id1 and id2 to denote location of error.  This is the return type for <code class="varname">ValidateTopology</code></span></dt></dl></div></div><div class="sect1" title="11.2. Topology Domains"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_Domains"></a>11.2. Topology Domains</h2></div><div><div class="abstract" title="Abstract"><p class="title"><b>Abstract</b></p><p>This section lists the PostgreSQL domains installed by PostGIS Topology.  Domains can be used like object types as return objects of functions or table columns. The distinction between
                    a domain and a type is that a domain is an existing type with a check constraint bound to it.
                </p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="topoelement.html">TopoElement</a></span><span class="refpurpose"> &#8212; An array of 2 integers generally used to identify a TopoGeometry component. </span></dt><dt><span class="refentrytitle"><a href="topoelementarray.html">TopoElementArray</a></span><span class="refpurpose"> &#8212; An array of TopoElement objects</span></dt></dl></div></div><div class="sect1" title="11.3. Topology and TopoGeometry Management"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_ManagementFunctions"></a>11.3. Topology and TopoGeometry Management</h2></div><div><div class="abstract" title="Abstract"><p class="title"><b>Abstract</b></p><p>This section lists the Topology functions for building new Topology schemas, validating topologies, and managing TopoGeometry Columns</p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="AddTopoGeometryColumn.html">AddTopoGeometryColumn</a></span><span class="refpurpose"> &#8212; Adds a topogeometry column to an existing table, registers this new column as a layer in topology.layer and returns the new layer_id.</span></dt><dt><span class="refentrytitle"><a href="DropTopology.html">DropTopology</a></span><span class="refpurpose"> &#8212; Use with caution: Drops a topology schema and deletes its reference from  topology.topology table and references to tables in that schema from the geometry_columns table.</span></dt><dt><span class="refentrytitle"><a href="DropTopoGeometryColumn.html">DropTopoGeometryColumn</a></span><span class="refpurpose"> &#8212; Drops the topogeometry column from the table named <code class="varname">table_name</code> in schema <code class="varname">schema_name</code> and unregisters the columns from topology.layer table.</span></dt><dt><span class="refentrytitle"><a href="TopologySummary.html">TopologySummary</a></span><span class="refpurpose"> &#8212; Takes a topology name and provides summary totals of types of objects in topology</span></dt><dt><span class="refentrytitle"><a href="ValidateTopology.html">ValidateTopology</a></span><span class="refpurpose"> &#8212; Returns a set of validatetopology_returntype objects detailing issues with topology</span></dt></dl></div></div><div class="sect1" title="11.4. Topology Constructors"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_Constructors"></a>11.4. Topology Constructors</h2></div><div><div class="abstract" title="Abstract"><p class="title"><b>Abstract</b></p><p>This section covers the topology functions for creating new topologies.</p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="CreateTopology.html">CreateTopology</a></span><span class="refpurpose"> &#8212; Creates a new topology schema and registers this new schema in the topology.topology table.</span></dt><dt><span class="refentrytitle"><a href="CopyTopology.html">CopyTopology</a></span><span class="refpurpose"> &#8212; Makes a copy of a topology structure (nodes, edges, faces, layers and TopoGeometries).</span></dt><dt><span class="refentrytitle"><a href="ST_InitTopoGeo.html">ST_InitTopoGeo</a></span><span class="refpurpose"> &#8212; Creates a new topology schema and registers this new schema in the topology.topology table and details summary of process.</span></dt><dt><span class="refentrytitle"><a href="ST_CreateTopoGeo.html">ST_CreateTopoGeo</a></span><span class="refpurpose"> &#8212; 
Adds a collection of geometries to a given empty topology and returns a message detailing success.  
				</span></dt><dt><span class="refentrytitle"><a href="TopoGeo_AddPoint.html">TopoGeo_AddPoint</a></span><span class="refpurpose"> &#8212; 
Adds a point to an existing topology using a tolerance and possibly splitting an existing edge.
				</span></dt><dt><span class="refentrytitle"><a href="TopoGeo_AddLineString.html">TopoGeo_AddLineString</a></span><span class="refpurpose"> &#8212; 
Adds a linestring to an existing topology using a tolerance and possibly splitting existing edges/faces. Returns edge identifiers
				</span></dt><dt><span class="refentrytitle"><a href="TopoGeo_AddPolygon.html">TopoGeo_AddPolygon</a></span><span class="refpurpose"> &#8212; 
Adds a polygon to an existing topology using a tolerance and possibly splitting existing edges/faces.
				</span></dt></dl></div></div><div class="sect1" title="11.5. Topology Editors"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_Editing"></a>11.5. Topology Editors</h2></div><div><div class="abstract" title="Abstract"><p class="title"><b>Abstract</b></p><p>This section covers topology functions for adding, moving, deleting, and splitting edges, faces, and nodes. All of these functions are defined by ISO SQL/MM.</p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="ST_AddIsoNode.html">ST_AddIsoNode</a></span><span class="refpurpose"> &#8212; Adds an isolated node to a face in a topology and returns the nodeid of the new node. If face is null, the node is still created.</span></dt><dt><span class="refentrytitle"><a href="ST_AddIsoEdge.html">ST_AddIsoEdge</a></span><span class="refpurpose"> &#8212; Adds an isolated edge defined by geometry <code class="varname">alinestring</code> to a topology connecting two existing isolated nodes <code class="varname">anode</code> and <code class="varname">anothernode</code> and returns the edge id of the new edge.</span></dt><dt><span class="refentrytitle"><a href="ST_AddEdgeNewFaces.html">ST_AddEdgeNewFaces</a></span><span class="refpurpose"> &#8212; Add a new edge and, if in doing so it splits a face, delete the original face and replace it with two new faces.</span></dt><dt><span class="refentrytitle"><a href="ST_AddEdgeModFace.html">ST_AddEdgeModFace</a></span><span class="refpurpose"> &#8212; Add a new edge and, if in doing so it splits a face, modify the original face and add a new face.</span></dt><dt><span class="refentrytitle"><a href="ST_RemEdgeNewFace.html">ST_RemEdgeNewFace</a></span><span class="refpurpose"> &#8212; 
Removes an edge and, if the removed edge separated two faces,
delete the original faces and replace them with a new face.
        </span></dt><dt><span class="refentrytitle"><a href="ST_RemEdgeModFace.html">ST_RemEdgeModFace</a></span><span class="refpurpose"> &#8212; 
Removes an edge and, if the removed edge separated two faces,
delete one of the them and modify the other to take the space of both.
        </span></dt><dt><span class="refentrytitle"><a href="ST_ChangeEdgeGeom.html">ST_ChangeEdgeGeom</a></span><span class="refpurpose"> &#8212; 
Changes the shape of an edge without affecting the topology structure.
				</span></dt><dt><span class="refentrytitle"><a href="ST_ModEdgeSplit.html">ST_ModEdgeSplit</a></span><span class="refpurpose"> &#8212; Split an edge by creating a new node along an existing edge, modifying the original edge and adding a new edge.</span></dt><dt><span class="refentrytitle"><a href="ST_ModEdgeHeal.html">ST_ModEdgeHeal</a></span><span class="refpurpose"> &#8212; 
Heal two edges by deleting the node connecting them, modifying the first edge
and deleting the second edge. Returns the id of the deleted node.
				</span></dt><dt><span class="refentrytitle"><a href="ST_NewEdgeHeal.html">ST_NewEdgeHeal</a></span><span class="refpurpose"> &#8212; 
Heal two edges by deleting the node connecting them, deleting both edges,
and replacing them with an edge whose direction is the same as the first
edge provided.
				</span></dt><dt><span class="refentrytitle"><a href="ST_MoveIsoNode.html">ST_MoveIsoNode</a></span><span class="refpurpose"> &#8212; Moves an isolated node in a topology from one point to another.  If new <code class="varname">apoint</code> geometry exists as a node an error is thrown. REturns description of move.</span></dt><dt><span class="refentrytitle"><a href="ST_NewEdgesSplit.html">ST_NewEdgesSplit</a></span><span class="refpurpose"> &#8212; Split an edge by creating a new node along an existing edge, deleting the original edge and replacing it with two new edges.  Returns the id of the new node created that joins the new edges.</span></dt><dt><span class="refentrytitle"><a href="ST_RemoveIsoNode.html">ST_RemoveIsoNode</a></span><span class="refpurpose"> &#8212; Removes an isolated node and returns description of action. If the node is not isolated (is start or end of an edge), then an exception is thrown.</span></dt></dl></div></div><div class="sect1" title="11.6. Topology Accessors"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_Accessors"></a>11.6. Topology Accessors</h2></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="GetEdgeByPoint.html">GetEdgeByPoint</a></span><span class="refpurpose"> &#8212; Find the edge-id of an edge that intersects a given point</span></dt><dt><span class="refentrytitle"><a href="GetFaceByPoint.html">GetFaceByPoint</a></span><span class="refpurpose"> &#8212; Find the face-id of a face that intersects a given point</span></dt><dt><span class="refentrytitle"><a href="GetNodeByPoint.html">GetNodeByPoint</a></span><span class="refpurpose"> &#8212; Find the id of a node at a point location</span></dt><dt><span class="refentrytitle"><a href="GetTopologyID.html">GetTopologyID</a></span><span class="refpurpose"> &#8212; Returns the id of a topology in the topology.topology table given the name of the topology.</span></dt><dt><span class="refentrytitle"><a href="GetTopologySRID.html">GetTopologySRID</a></span><span class="refpurpose"> &#8212; Returns the SRID of a topology in the topology.topology table given the name of the topology.</span></dt><dt><span class="refentrytitle"><a href="GetTopologyName.html">GetTopologyName</a></span><span class="refpurpose"> &#8212; Returns the name of a topology (schema) given the id of the topology.</span></dt><dt><span class="refentrytitle"><a href="ST_GetFaceEdges.html">ST_GetFaceEdges</a></span><span class="refpurpose"> &#8212; Returns a set of ordered edges that bound <code class="varname">aface</code>.</span></dt><dt><span class="refentrytitle"><a href="ST_GetFaceGeometry.html">ST_GetFaceGeometry</a></span><span class="refpurpose"> &#8212; Returns the polygon in the given topology with the specified face id.</span></dt><dt><span class="refentrytitle"><a href="GetRingEdges.html">GetRingEdges</a></span><span class="refpurpose"> &#8212; 
Returns an ordered set of edges forming a ring with the given edge .
				</span></dt><dt><span class="refentrytitle"><a href="GetNodeEdges.html">GetNodeEdges</a></span><span class="refpurpose"> &#8212; 
Returns an ordered set of edges incident to the given node.
				</span></dt></dl></div></div><div class="sect1" title="11.7. Topology Processing"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_Processing"></a>11.7. Topology Processing</h2></div><div><div class="abstract" title="Abstract"><p class="title"><b>Abstract</b></p><p>This section covers the functions for processing topologies in non-standard ways.</p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="TopologyPolygonize.html">Polygonize</a></span><span class="refpurpose"> &#8212; Find and register all faces defined by topology edges</span></dt><dt><span class="refentrytitle"><a href="AddNode.html">AddNode</a></span><span class="refpurpose"> &#8212; Adds a point node to the node table in the specified topology schema and returns the nodeid of new node. If point already exists as node, the existing nodeid is returned.</span></dt><dt><span class="refentrytitle"><a href="AddEdge.html">AddEdge</a></span><span class="refpurpose"> &#8212; Adds a linestring edge to the edge table and associated start and end points to the point nodes table of the specified topology schema using the specified linestring geometry and returns the edgeid of the new (or existing) edge.</span></dt><dt><span class="refentrytitle"><a href="AddFace.html">AddFace</a></span><span class="refpurpose"> &#8212; 
Registers a face primitive to a topology and get it's identifier.
        </span></dt><dt><span class="refentrytitle"><a href="TP_ST_Simplify.html">ST_Simplify</a></span><span class="refpurpose"> &#8212; Returns a "simplified" geometry version of the given TopoGeometry using
				the Douglas-Peucker algorithm.</span></dt></dl></div></div><div class="sect1" title="11.8. TopoGeometry Constructors"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="TopoGeometry_Constructors"></a>11.8. TopoGeometry Constructors</h2></div><div><div class="abstract" title="Abstract"><p class="title"><b>Abstract</b></p><p>This section covers the topology functions for creating new topogeometries.</p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="CreateTopoGeom.html">CreateTopoGeom</a></span><span class="refpurpose"> &#8212; Creates a new topo geometry object from topo element array - tg_type: 1:[multi]point, 2:[multi]line, 3:[multi]poly, 4:collection</span></dt><dt><span class="refentrytitle"><a href="toTopoGeom.html">toTopoGeom</a></span><span class="refpurpose"> &#8212; 
Converts a simple Geometry into a topo geometry
        </span></dt><dt><span class="refentrytitle"><a href="TopoElementArray_Agg.html">TopoElementArray_Agg</a></span><span class="refpurpose"> &#8212; Returns a <code class="varname">topoelementarray</code> for a set of element_id, type arrays (topoelements)</span></dt></dl></div></div><div class="sect1" title="11.9. TopoGeometry Editors"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="TopoGeometry_Editors"></a>11.9. TopoGeometry Editors</h2></div><div><div class="abstract" title="Abstract"><p class="title"><b>Abstract</b></p><p>This section covers the topology functions for editing existing topogeometries.</p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="clearTopoGeom.html">clearTopoGeom</a></span><span class="refpurpose"> &#8212; Clears the content of a topo geometry</span></dt><dt><span class="refentrytitle"><a href="toTopoGeom_editor_proxy.html">toTopoGeom</a></span><span class="refpurpose"> &#8212; Adds a geometry shape to an existing topo geometry</span></dt></dl></div></div><div class="sect1" title="11.10. TopoGeometry Accessors"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="TopoGeom_Accessors"></a>11.10. TopoGeometry Accessors</h2></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="GetTopoGeomElementArray.html">GetTopoGeomElementArray</a></span><span class="refpurpose"> &#8212; Returns a <code class="varname">topoelementarray</code> (an array of topoelements) containing the topological elements and type of the given TopoGeometry (primitive elements)</span></dt><dt><span class="refentrytitle"><a href="GetTopoGeomElements.html">GetTopoGeomElements</a></span><span class="refpurpose"> &#8212; Returns a set of <code class="varname">topoelement</code> objects containing the topological  element_id,element_type of the given TopoGeometry (primitive elements)</span></dt></dl></div></div><div class="sect1" title="11.11. TopoGeometry Outputs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="TopoGeometry_Outputs"></a>11.11. TopoGeometry Outputs</h2></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="AsGML.html">AsGML</a></span><span class="refpurpose"> &#8212; Returns the GML representation of a topogeometry.</span></dt><dt><span class="refentrytitle"><a href="AsTopoJSON.html">AsTopoJSON</a></span><span class="refpurpose"> &#8212; Returns the TopoJSON representation of a topogeometry.</span></dt></dl></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="RT_FAQ.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="getfaceedges_returntype.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 10. PostGIS Raster Frequently Asked Questions </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> getfaceedges_returntype</td></tr></table></div></body></html>
